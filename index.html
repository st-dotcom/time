<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chronos Singularity</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Syncopate:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --accent: #00f2ff;
            --bg-dark: #0a0a12;
            --glass: rgba(255, 255, 255, 0.05);
        }

        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, #1b1b3a 0%, var(--bg-dark) 100%);
            color: #fff;
            font-family: 'Orbitron', sans-serif;
            overflow: hidden;
        }

        /* 背景の浮遊文字コンテナ */
        #canvas-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .floating-letter {
            position: absolute;
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--accent);
            text-shadow: 0 0 8px var(--accent);
            opacity: 0;
            user-select: none;
            will-change: transform, opacity;
        }

        /* 【重要】位置ズレを防ぐための絶対配置コンテナ 
           ボタンと時計は常にこの中心点に重なって表示されます
        */
        .center-stage {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 100;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 0;     /* 幅を持たせないことでフローの影響を受けない */
            height: 0;
            overflow: visible; /* 中身がはみ出しても見えるように */
        }

        /* ボタンのデザイン */
        .button {
            position: absolute; /* 親の中心に固定 */
            padding: 15px 40px;
            font-family: 'Syncopate', sans-serif;
            font-size: 1.2rem;
            letter-spacing: 5px;
            background: rgba(0, 242, 255, 0.1);
            border: 1px solid var(--accent);
            color: var(--accent);
            backdrop-filter: blur(5px);
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 0 15px rgba(0, 242, 255, 0.2);
            white-space: nowrap; /* 文字折り返し防止 */
        }

        .button:hover {
            background: var(--accent);
            color: var(--bg-dark);
            box-shadow: 0 0 40px var(--accent);
            transform: scale(1.05);
        }

        /* 時刻表示のデザイン */
        #timeDisplay {
            position: absolute; /* 親の中心に固定 */
            font-size: 4rem;
            font-weight: 700;
            letter-spacing: 4px;
            color: white;
            text-shadow: 0 0 20px var(--accent);
            opacity: 0;
            white-space: nowrap;
            pointer-events: none;
        }

        .time-char {
            display: inline-block;
        }

        /* ====================
           アニメーション定義
           ==================== */

        /* 通常時の浮遊 */
        @keyframes drift {
            0% { transform: translate(0, 0) rotate(0deg); opacity: 0; }
            20% { opacity: 0.6; }
            80% { opacity: 0.6; }
            100% { transform: translate(var(--dx), var(--dy)) rotate(360deg); opacity: 0; }
        }

        /* ビッグバン：収束 (Implode) */
        @keyframes implode {
            0% { 
                opacity: 1;
                transform: translate(0, 0) scale(1);
            }
            100% { 
                opacity: 0;
                /* 中心(--tx, --ty)に向かって吸い込まれる */
                transform: translate(var(--tx), var(--ty)) scale(0.1); 
            }
        }

        /* ビッグバン：爆発 (Explode) */
        @keyframes explode {
            0% { 
                opacity: 0; 
                transform: scale(0.5) rotate(0deg);
                filter: blur(10px);
            }
            50% {
                opacity: 1;
                transform: scale(1.1);
            }
            100% { 
                opacity: 1; 
                transform: scale(1) rotate(0deg);
                filter: blur(0px);
            }
        }
        
        /* 時刻が消える時の拡散 */
        @keyframes vanish {
            to { transform: translate(var(--ex), var(--ey)) scale(2); opacity: 0; }
        }
    </style>
</head>
<body>

    <div id="canvas-container"></div>

    <div class="center-stage">
        <button id="mainButton" class="button">TIME</button>
        <div id="timeDisplay"></div>
    </div>

    <script>
        const container = document.getElementById('canvas-container');
        const mainButton = document.getElementById('mainButton');
        const timeDisplay = document.getElementById('timeDisplay');
        let letterInterval;

        // ランダムな文字を生成して浮遊させる
        function createLetter() {
            const letter = document.createElement('div');
            const chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZPROCESS_LOADING_SYSTEM_CHECK';
            letter.className = 'floating-letter';
            letter.textContent = chars[Math.floor(Math.random() * chars.length)];
            
            // 画面内のランダムな位置に出現
            const startX = Math.random() * window.innerWidth;
            const startY = Math.random() * window.innerHeight;
            
            letter.style.left = startX + 'px';
            letter.style.top = startY + 'px';
            
            // 浮遊する方向と距離をランダムに
            letter.style.setProperty('--dx', `${(Math.random() - 0.5) * 200}px`);
            letter.style.setProperty('--dy', `${(Math.random() - 0.5) * 200}px`);
            
            letter.style.animation = `drift ${5 + Math.random() * 5}s linear infinite`;
            
            container.appendChild(letter);
            
            // 画面外に出たり時間が経ったら削除
            setTimeout(() => {
                if(letter.parentNode) letter.remove();
            }, 10000);
        }

        function startFloating() {
            // 定期的に文字を生成
            letterInterval = setInterval(createLetter, 100);
        }

        // ==========================================
        //  ここがビッグバンの心臓部 (Click Action)
        // ==========================================
        mainButton.addEventListener('click', () => {
            clearInterval(letterInterval); // 新しい文字の生成を停止
            
            // 1. ボタンを隠す
            mainButton.style.opacity = '0';
            mainButton.style.pointerEvents = 'none'; // クリック不可に

            // 2. 画面上の全ての文字を中心（ボタンの位置）に吸い込む
            const letters = document.querySelectorAll('.floating-letter');
            
            // 画面中心座標を取得
            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2;

            letters.forEach(letter => {
                // 文字の現在位置を取得
                const rect = letter.getBoundingClientRect();
                const currentLeft = rect.left;
                const currentTop = rect.top;

                // 中心までの距離（ベクトル）を計算
                // 「中心 - 現在地」が移動すべき距離
                const moveX = centerX - currentLeft;
                const moveY = centerY - currentTop;

                // CSS変数にセット
                letter.style.setProperty('--tx', `${moveX}px`);
                letter.style.setProperty('--ty', `${moveY}px`);

                // 既存のアニメーションを上書きして「吸い込み」アニメーションを発動
                // cubic-bezierで「急激に加速して吸い込まれる」動きを表現
                letter.style.animation = 'implode 0.6s cubic-bezier(0.6, -0.28, 0.735, 0.045) forwards';
            });

            // 3. 吸い込み終わったタイミング(0.6秒後)で時刻を爆発表示
            setTimeout(() => {
                // 文字を全て消す
                container.innerHTML = '';
                
                showExplosiveTime();
            }, 600);
        });

        function showExplosiveTime() {
            const now = new Date();
            // 見やすいフォーマットで時刻取得
            const timeStr = now.toLocaleTimeString('en-US', { hour12: false });
            
            timeDisplay.innerHTML = '';
            
            // 時刻を一文字ずつspanで囲む
            [...timeStr].forEach((char) => {
                const span = document.createElement('span');
                span.className = 'time-char';
                span.textContent = char;
                timeDisplay.appendChild(span);
            });

            timeDisplay.style.opacity = '1';
            
            // 時刻自体に爆発アニメーションを適用
            // .time-char ではなく #timeDisplay 全体、あるいは文字ごとに適用も可能
            // ここではシンプルに文字を表示
            const chars = timeDisplay.querySelectorAll('.time-char');
            chars.forEach((c, i) => {
                c.style.animation = `explode 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards`;
                c.style.animationDelay = `${i * 0.05}s`; // 少しずつずらして表示
            });

            // 4. 数秒後に時刻を拡散させて、初期状態に戻す
            setTimeout(resetSystem, 4000);
        }

        function resetSystem() {
            // 時刻を拡散させて消す
            const chars = document.querySelectorAll('.time-char');
            chars.forEach(char => {
                char.style.setProperty('--ex', `${(Math.random() - 0.5) * 500}px`);
                char.style.setProperty('--ey', `${(Math.random() - 0.5) * 500}px`);
                char.style.animation = 'vanish 0.8s ease-in forwards';
            });

            // アニメーション終了後にリセット
            setTimeout(() => {
                timeDisplay.style.opacity = '0';
                timeDisplay.innerHTML = '';
                
                // ボタンを復活
                mainButton.style.opacity = '1';
                mainButton.style.pointerEvents = 'auto';
                
                // 浮遊文字を再開
                startFloating();
            }, 800);
        }

        // 初期化
        startFloating();

        // ウィンドウサイズが変わった時に中心ズレを防ぐためのリサイズイベント（念の為）
        window.addEventListener('resize', () => {
            // CSSの transform: translate(-50%, -50%) で制御しているので
            // JS側での特別な計算は不要です。これがCSSセンタリングの強みです。
        });

    </script>
</body>
</html>
